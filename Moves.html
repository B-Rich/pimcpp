<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Moves &mdash; PIMC++ 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="PIMC++ 1.0.0 documentation" href="index.html" />
    <link rel="up" title="Input File" href="Input.html" />
    <link rel="next" title="Algorithm" href="Algorithm.html" />
    <link rel="prev" title="Observables" href="Observables.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="Algorithm.html" title="Algorithm"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Observables.html" title="Observables"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">PIMC++ 1.0.0 documentation</a> &raquo;</li>
          <li><a href="Input.html" accesskey="U">Input File</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="moves">
<h1>Moves<a class="headerlink" href="#moves" title="Permalink to this headline">¶</a></h1>
<p>To add a move to your calculation, there are two steps. One needs to
define the move and then one needs to tell PIMC++ when to use the move
in the algorithm.</p>
<p>(Note: Moves sometimes write data like acceptance ratios. This data is
written when the algorithm reaches the WriteData section)</p>
<div class="section" id="defining-the-move">
<h2>Defining the move<a class="headerlink" href="#defining-the-move" title="Permalink to this headline">¶</a></h2>
<p>All moves are defined in their respective section <strong>Move</strong> in the
overall section <strong>Moves</strong></p>
<div class="highlight-python"><pre>Section(Moves)
{
  Section (Move)
  {
    string Type="BisectionBlock";
    string Name="HeliumBisection";
    string PermuteType="NONE";
  }
  Section (Move)
  {
    ...
  }
}</pre>
</div>
<p>All moves have (at minimum) the variables <em>Type</em> and <em>Name</em> must be
specified. The variable <em>Type</em> tells the code which move to use (i.e.
bisection block, displace move, etc). The string to use may be found
below in the list of moves. The variable <em>Name</em> is a name you choose for
the move to be used later on when you call it in the algorithm. For
example, your Name might be &#8220;BisectionMoveForHelium&#8221;.</p>
</div>
<div class="section" id="inserting-the-move-into-the-algorithm">
<h2>Inserting the move into the algorithm<a class="headerlink" href="#inserting-the-move-into-the-algorithm" title="Permalink to this headline">¶</a></h2>
<p>A sample algorithm looks like:</p>
<div class="highlight-python"><pre>Section (Algorithm)
{
  Section (Loop){ //Start Accumulating observables
    int Steps=3000000000;
    Section (Loop){
      int Steps=100;
      Section (Move) {string Name="BisectionMoveForHelium";}
      Section (Loop){
        int Steps=10;
        Section (Move) {string Name="Displace";}
      }
      Section (Move) {string Name="CenterOfMass";}
      Section (Observe) {string Name = "Vacancy"; }
      Section (Observe) {string Name = "PathDump"; }
      Section (Observe) {string Name = "StructureFactor"; }
      Section (Observe) {string Name = "TimeAnalysis"; }
      Section (Observe) {string Name = "CycleCount"; }
      Section (Move) {string Name = "Shift"; }
    }
    Section (WriteData){}
  }
}</pre>
</div>
<p>To add your move to the algorithm, you must place in a line like:
Section (Move) {string Name=&#8221;BisectionMoveForHelium&#8221;;} where the name is
the name you have chosen for your move.</p>
</div>
<div class="section" id="list-of-moves">
<h2>List of Moves<a class="headerlink" href="#list-of-moves" title="Permalink to this headline">¶</a></h2>
<p>Note: All Moves include a paramater <em>Name</em> that is user specified.</p>
<div class="section" id="bisection-block">
<h3>Bisection Block<a class="headerlink" href="#bisection-block" title="Permalink to this headline">¶</a></h3>
<p>The bisection block is the primary move in PIMC++. It implements the
Bisection move as documented in David Ceperley rev mod phys article
(somebody please link to this).</p>
<p>The bisection block has a number of sophisticated switches that turn
certain actions on and off. I am currently documenting it&#8217;s most typical
use.</p>
<p><em>Example input:</em></p>
<div class="highlight-python"><pre>Section (Move) {
    string Type="BisectionBlock";
    string Name="BisectionBlock";
    string PermuteType="TABLE";
    string Species="He";
    Array&lt;double,1&gt; Gamma(4) = [1.0, 1.0, 1.0, 1.0];
    double epsilon=1e-5;
    int NumLevels=2;
    int StepsPerBlock=100;
  }</pre>
</div>
<p><em>Input Paramaters:</em></p>
<ul class="simple">
<li><strong>Type:</strong> BisectionBlock</li>
<li><strong>Species:</strong> Specifies a string for the Name (NOT Type) of the
species BisectionBlock acts on (this species must show up as the Name
of a species specified earlier in the input file).</li>
<li><strong>NumLevels:</strong> Number of levels in which to perform a bisection.</li>
<li><strong>StepsPerBlock:</strong> A BisectionBlock chooses a set of time slices (of
size 2^level) in which to work. Then it makes moves on these time
slices StepsPerBlock times. This is done to amortize the cost of
building tables for the permutations. If you are using permutations
in the code it is suggested that you select StepsPerBlock to be
between the number of particles and number of particles squared.</li>
<li><strong>PermuteType:</strong> Specifies how permutations are done on the species.
The current choices are:<ul>
<li>NONE: No permutations are done</li>
<li>TABLE: Permutations up to size four are done. These permutations
are chosen by building a table of all possible four particle
permutations and choosing a permutation proportional to (check
that) where d is the distance between the first and last time
slice the Bisection Block is working on. If TABLE is chosen, there
are two additional input paramaters that are to be used:<ul>
<li><strong>epsilon:</strong> A double that sets a minimum unnormalized
probability for any permutations for permutations which are
pushed onto the table to be allowed to have. Permutations with
an unnormalized probability less then this are not included.
Because of how things are implemented this leads to a small
bias.</li>
<li><strong>Array Gamma(4):</strong> An array of size four that specifies a
multiplicative factor to increase the unnormalized probability
of permutations of size 1,2,3, and 4 respectively. These
multiplicative factors must all be above 1 (we should check
this in the code!)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><em>Output Paramaters</em></p>
<ul class="simple">
<li><strong>AcceptRatio:</strong> Contains a global acceptance ratio of the entire
system as well as an acceptance ratio of each bisection stage. The
remaining stages are different levels of the bisection move where the
last stage is the lowest level. Each stage specifies the percentage
of moves that got to that level and then succeeded in getting to the
next stage. (So the acceptance ratio of the total move should be the
product of all the stages).</li>
<li><strong>CenterOfMassDrift:</strong> This specifies how far the squared center of
mass has been moved by this move. By dividing it by the time spent in
this move you can calculate your average diffusion rate.</li>
</ul>
</div>
<div class="section" id="center-of-mass-move">
<h3>Center of Mass Move<a class="headerlink" href="#center-of-mass-move" title="Permalink to this headline">¶</a></h3>
<p>When PIMC++ is initialized, it calculates the center of mass of all the
particles. Then after a move has been accepted it calculates how that
center of mass is changed. This is done to resolve problems concerning
calculating the center of mass in a periodic box. This is done
independent of whether or not this move is defined.</p>
<p>If this move is defined and called in the algorithm, the entire system
is moved so that the center of mass displacement is now 0. The move
always accepts (if you are running a simulation that has an action (such
as an external potential) that changes when the entire system is moved
by a constant DO NOT USE THIS MOVE as it is currently implemented)</p>
<p><em>Example input:</em></p>
<div class="highlight-python"><pre>Section (Move){
    string Type="CenterOfMass";
    string Name="CenterOfMass";
  }</pre>
</div>
<p><em>Input Paramaters:</em></p>
<ul class="simple">
<li><strong>Type:</strong> CenterOfMass</li>
</ul>
<p><em>Output Paramaters:</em></p>
<ul class="simple">
<li><strong>AcceptRatio:</strong> Although appearing in the output file, this is irrelevant because everything is always accepted.</li>
</ul>
</div>
<div class="section" id="displace-move">
<h3>Displace Move<a class="headerlink" href="#displace-move" title="Permalink to this headline">¶</a></h3>
<p>The displace move chooses a particle among all particles of a certain
species and displaces that particle a distance d where d is chosen from
a gaussian with width sigma. The displace move does not attempt to move
a particle if it is part of a permutation. Note: There is a bug in the
displace move that well cause the code to loop forever if all particles
are in a permutation. This needs to be fixed. Note: The displace move
doesn&#8217;t push the kinetic action back onto its action list and
consequently will never calculate it. If for some unknown reason your
system changes the kinetic action when particles are displaced, this
will obviously cause a bug.</p>
<p><em>Example input:</em></p>
<div class="highlight-python"><pre>Section (Move) {
    string Type="Displace";
    string Name="Displace";
    double Sigma=0.5;
    Array&lt;string,1&gt; ActiveSpecies(1)=["He"];
    int NumToMove=1;
  }</pre>
</div>
<p><em>Input Paramaters:</em></p>
<ul class="simple">
<li><strong>Type:</strong> Displace</li>
<li><strong>Sigma:</strong> Width of gaussian from which displacement is chosen</li>
<li><strong>Array ActiveSpecies(1):</strong> List of species which displacement acts upon.</li>
<li><strong>int NumToMove:</strong> Number of particles in which to move at one time.</li>
</ul>
<p><em>Output Paramaters:</em></p>
<ul class="simple">
<li><strong>AcceptRatio:</strong> Outputs the percent of these moves that have been accepted. Due to technical details of the implementation also outputs the acceptance ratio of a single stage that is the same value.</li>
</ul>
</div>
<div class="section" id="shift-move">
<h3>Shift Move<a class="headerlink" href="#shift-move" title="Permalink to this headline">¶</a></h3>
<p>All code in PIMC++ follows the invariant that the initial and final time
slice in memory are not to be altered. Notice, without time slice
parallelization these two time slices will be permutations of one
another. With time slice parallelization, the last time slice of
processor i will be a permutation of the first time slice of processor
i+1 (modulo the number of processors). Keeping this invariant is crucial
to the correct functioning of the code.</p>
<p>A Shift Move shifts the data by a number of time slices (randomly chosen
in some range) to allow time slices that are on the border between
processors (or the last time slice on a processor if there is only one
processor) to be moved.</p>
<p>It is very important to use a shift move occassionally or certain time
slices will never be updated.</p>
<p>Shift Moves are always accepted.</p>
<p><em>Example input:</em></p>
<div class="highlight-python"><pre>Section (Move)
    {
      string Type="ShiftMove";
      string Name="Shift";
    }</pre>
</div>
<p><em>Input Paramaters:</em></p>
<ul class="simple">
<li><strong>Type:</strong> ShiftMove</li>
</ul>
<p><em>Output Paramaters:</em></p>
<ul class="simple">
<li><strong>AcceptRatio:</strong> Although appearing in the output file, this is irrelevant because everything is always accepted</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Moves</a><ul>
<li><a class="reference internal" href="#defining-the-move">Defining the move</a></li>
<li><a class="reference internal" href="#inserting-the-move-into-the-algorithm">Inserting the move into the algorithm</a></li>
<li><a class="reference internal" href="#list-of-moves">List of Moves</a><ul>
<li><a class="reference internal" href="#bisection-block">Bisection Block</a></li>
<li><a class="reference internal" href="#center-of-mass-move">Center of Mass Move</a></li>
<li><a class="reference internal" href="#displace-move">Displace Move</a></li>
<li><a class="reference internal" href="#shift-move">Shift Move</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="Observables.html"
                        title="previous chapter">Observables</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Algorithm.html"
                        title="next chapter">Algorithm</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/Moves.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="Algorithm.html" title="Algorithm"
             >next</a> |</li>
        <li class="right" >
          <a href="Observables.html" title="Observables"
             >previous</a> |</li>
        <li><a href="index.html">PIMC++ 1.0.0 documentation</a> &raquo;</li>
          <li><a href="Input.html" >Input File</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Ken Esler, Bryan Clark, Ethan Brown.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>